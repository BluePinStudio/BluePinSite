<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ProductiviTree üå≥</title>

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Open Graph for Discord -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.bluepinstudio.com/productivitree/">
  <meta property="og:title" content="ProductiviTree ‚Äì Gamified Task Tree">
  <meta property="og:description" content="Build and complete task tech trees. Visualize blockers and dependencies.">
  <meta property="og:image" content="https://www.bluepinstudio.com/productivitree/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ProductiviTree ‚Äì Gamified Task Tree">
  <meta name="twitter:description" content="Build and complete task tech trees. Visualize blockers and dependencies.">
  <meta name="twitter:image" content="https://www.bluepinstudio.com/productivitree/og-image.png">

  <!-- Embed color -->
  <meta name="theme-color" content="#b88a35">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5TPPRZVDVF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5TPPRZVDVF');
  </script>
</head>

<body class="theme-war">
  <header>
    <div class="wrap">
      <div class="brand">
        <!-- Home button (styled like other buttons) -->
        <a class="btn primary" id="homeBtn" href="https://bluepinstudio.com"
           title="Go to Blue Pin Studio" aria-label="Go to Blue Pin Studio">‚Üê Home</a>

        <h1>ProductiviTree üå≥</h1>
        <span class="pill">Tech Tree Task Tracker</span>

        <div class="theme-wrap" aria-label="Theme chooser">
          <span class="theme-label">Theme</span>
          <select id="themeSelect" class="theme-select">
            <option value="war">War</option>
            <option value="girly-pop">Girly Pop</option>
            <option value="whacky-pomo">Wacky Pomo</option>
            <option value="fruloo">Fruloo</option>
          </select>
        </div>

        <button class="btn" id="fxToggleBtn" aria-pressed="true" title="Toggle background particles">
          FX: On
        </button>
      </div>

      <div class="toolbar">
        <button class="btn primary" id="addNodeBtn">+ Add Node (N)</button>
        <button class="btn" id="linkBtn">Link Nodes (L)</button>

        <div class="dropdown">
          <button class="btn" id="gridBtn" title="Grid options">Grid ‚ñæ</button>
          <div class="menu" id="gridMenu">
            <div class="row">
              <label for="gridVisible">Show grid</label>
              <input type="checkbox" id="gridVisible" />
            </div>
            <div class="row">
              <label for="gridSize">Grid size (px)</label>
              <input type="number" id="gridSize" min="4" step="1" value="24" />
            </div>
            <div class="row">
              <label for="gridSnap">Snap to grid</label>
              <input type="checkbox" id="gridSnap" />
            </div>
          </div>
        </div>

        <button class="btn" id="zoomOutBtn">‚àí</button>
        <button class="btn" id="zoomResetBtn">100%</button>
        <button class="btn" id="zoomInBtn">+</button>

        <button class="btn danger" id="clearBtn">Clear</button>

        <button class="btn" id="setExportFolderBtn" title="Choose a folder to save exports">
          Set Export Folder
        </button>

        <button class="btn" id="exportWsBtn" title="Export all workspaces as JSON">Export JSON</button>
        <button class="btn" id="importWsBtn" title="Import workspaces from JSON">Import JSON</button>
        <input type="file" id="importFileInput" accept="application/json,.json" style="display:none" />
      </div>
    </div>

    <!-- Workspace ribbon bar -->
    <div class="workspace-bar">
      <div class="workspace-wrap">
        <div class="ribbons" id="wsRibbons"></div>
        <div class="ws-actions">
          <button class="btn" id="wsNew">New Workspace</button>
          <button class="btn" id="wsRename">Rename</button>
          <button class="btn danger" id="wsDelete">Delete</button>
          <button class="btn" id="wsColorBtn" title="Workspace color">üé® Color</button>
        </div>
      </div>
    </div>
  </header>

  <section class="board-wrap panel" id="wrap">
    <div id="stage">
      <div id="grid"></div>
      <svg class="links" id="linkSvg" viewBox="0 0 1800 1000" preserveAspectRatio="none"></svg>
      <canvas id="fxCanvas" aria-hidden="true"></canvas>
      <div id="burstFx" aria-hidden="true"></div>
      <div id="board"></div>
    </div>
  </section>

  <aside class="sidebar" id="sidebar" hidden>
    <div class="card panel" style="padding: 12px">
      <h3 id="sideTitle">Node</h3>
      <label for="titleInput">Title</label>
      <input id="titleInput" type="text" placeholder="Name your task" style="
        width:100%;padding:8px;background:#0b1118;color:#d9e6ef;
        border:1px solid rgba(255,255,255,.08);border-radius:10px;" />
      <label for="descInput">Description</label>
      <textarea id="descInput" placeholder="Optional details" style="
        width:100%;min-height:80px;padding:8px;background:#0b1118;color:#d9e6ef;
        border:1px solid rgba(255,255,255,.08);border-radius:10px;"></textarea>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button class="btn" id="toggleDoneBtn">Toggle Done</button>
        <button class="btn danger" id="deleteBtn">Delete</button>
      </div>
      <label>Dependencies</label>
      <div id="depsList" style="font-size:13px;color:#9fb2bf"></div>
    </div>
  </aside>

  <div class="toast" id="toast"></div>

  <!-- Color wheel popover -->
  <div class="popover-backdrop" id="colorPopover">
    <div class="color-pop">
      <canvas id="wheelCanvas" width="220" height="220"></canvas>
      <div class="row" style="margin:6px 0 4px">
        <div class="swatch" id="swatch"></div>
        <input class="slider" id="valSlider" type="range" min="0" max="100" value="100" />
        <input class="hexfield" id="hexField" placeholder="#c79039" />
      </div>
      <div class="pop-actions">
        <button class="btn" id="cancelColor">Cancel (Esc)</button>
        <button class="btn primary" id="applyColor">Apply</button>
      </div>
    </div>
  </div>

  <!-- Local audio -->
  <audio id="s-cheer" src="cheer.wav" preload="auto"></audio>

  <!-- Javascript -->
  <script src="script.js"></script>
</body>
</html>
